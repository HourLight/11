<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>é¦¥éˆä¹‹é‘° Hour Lightï½œèŠ³é¦™èƒ½é‡èª¿é »ç·šä¸ŠæŠ½ç‰Œ</title>
<link rel="icon" type="image/x-icon" href="favicon.ico">
<style>
/* â€¦â€¦åŸæœ¬ CSS å…¨ç•™â€¦â€¦ */
body{/*...*/}
h1{/*...*/}
button{/*...*/}
.card-container{/*...*/}
/* â˜…â˜… æ–°å¢ï¼šè§£ç‰Œçµæœå€å¡Šæ¨£å¼ â˜…â˜… */
#answer{
  white-space:pre-wrap;background:rgba(255,255,255,.9);
  border:1px solid #bbb;padding:15px;margin:25px auto;
  max-width:800px;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,.1);
  font-size:18px;line-height:1.6;color:#333;display:none;
}
</style>
</head>
<body>

<!-- çœç•¥å‰é¢èªªæ˜èˆ‡æŒ‰éˆ•çš„ HTMLï¼Œä¸è®Š -->

<div id="result"></div>

<!-- â˜…â˜… æ–°å¢ï¼šç›´æ¥è§£ææŒ‰éˆ• â˜…â˜… -->
<button id="interpretBtn" style="background:#6b4f3e;">ğŸŒ¿ ç›´æ¥è§£æï¼ˆä¸è·³è½‰ï¼‰</button>

<button id="copyBtn" onclick="copyResult()">ğŸ“‹ è¤‡è£½ç‰Œå¡ç·¨è™Ÿ</button>

<!-- â€¦â€¦åŸæœ¬ Step 3 èªªæ˜å€ã€é ç´„å€ã€è¿”å›é¦–é æŒ‰éˆ•â€¦â€¦ -->

<!-- â˜…â˜… æ–°å¢ï¼šé¡¯ç¤º GPT è§£ç‰Œæ–‡å­— â˜…â˜… -->
<div id="answer"></div>

<script>
let selectedCards = [];

/* ä½ çš„ç¾æœ‰å‡½å¼ï¼šæ ¼å¼åŒ–ï¼‹æŠ½ç‰Œï¼‹è¤‡è£½ï¼Œéƒ½ä¿ç•™ */
function formatCardNumber(card){
  return card<=22?'A'+(card-1).toString().padStart(2,'0'):(card-22).toString().padStart(3,'0');
}
function drawCards(num){
  alert("è«‹é–‰ä¸Šçœ¼ç›ï¼Œæ·±å‘¼å¸ï¼Œå°ˆå¿ƒæƒ³è‘—æ‚¨çš„å•é¡Œï¼Œå†é»æ“Šç¢ºèªã€‚(é—œé–‰æŒ‰ä¸‹å¾Œå³æŠ½ç‰Œ");
  selectedCards=[];
  while(selectedCards.length<num){
    let n=Math.floor(Math.random()*130)+1;
    if(!selectedCards.includes(n))selectedCards.push(n);
  }
  const resultDiv=document.getElementById('result');
  resultDiv.innerHTML='';
  selectedCards.forEach(c=>{
    const fc=formatCardNumber(c);
    const box=document.createElement('div');
    box.className='card-container';
    box.innerHTML=`
      <img src="https://github.com/HourLight/11/raw/main/LINE_ALBUM_2025.3.23_250323_${c}.jpg">
      <div class="card-number">ç·¨è™Ÿï¼š${fc}</div>`;
    resultDiv.appendChild(box);
  });
  document.getElementById('answer').style.display='none';       // æŠ½æ–°ç‰Œå…ˆéš±è—èˆŠè§£æ
}

function copyResult(){
  if(selectedCards.length===0){alert("è«‹å…ˆæŠ½ç‰Œå¾Œå†è¤‡è£½ï¼");return;}
  const txt=selectedCards.map(formatCardNumber).join(', ');
  navigator.clipboard.writeText(txt).then(()=>alert('æŠ½ç‰Œç·¨è™Ÿå·²è¤‡è£½ï¼'))
    .catch(()=>alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½ï¼š'+txt));
}

/* â˜…â˜… æ–°å¢ï¼šå‘¼å«ä½ è‡ªå·±çš„ GPT å¾Œç«¯å–å¾—è§£ç‰Œ â˜…â˜… */
async function interpretNow(){
  if(selectedCards.length===0){
    alert("è«‹å…ˆæŠ½ç‰Œï¼Œå†é»è§£æï¼");return;
  }
  const prompt=selectedCards.map(formatCardNumber).join(', ');
  const answerBox=document.getElementById('answer');
  answerBox.textContent='æ€è€ƒä¸­â€¦';
  answerBox.style.display='block';
  try{
    const res=await fetch('https://ai-x2if.onrender.com/api/chat',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({prompt})
    });
    const data=await res.json();
    answerBox.textContent=data.text||data.error||'è§£æå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ï¼';
  }catch(e){
    answerBox.textContent='ä¼ºæœå™¨æ‰“çŒç¡ï¼Œè«‹ç¨å¾Œå†è©¦ï¼';
    console.error(e);
  }
}
document.getElementById('interpretBtn').addEventListener('click',interpretNow);
</script>
</body>
</html>
